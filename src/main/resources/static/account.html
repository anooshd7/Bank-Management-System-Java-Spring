<!DOCTYPE html>
<html>

<head>
    <title>Account Management</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="flex flex-col w-full h-full justify-center text-center items-center bg-gray-200">
    <div class="font-bold text-3xl mb-8">Account Management</div>

    <div class="flex flex-col w-full items-center justify-center mb-8">
        <div class="font-semibold text-xl">Create Account</div>
        <form id="createAccountForm" class="gap-2 flex flex-col items-center mb-4 p-4 border rounded bg-white">
            <div class="flex gap-2">
                <label for="accountHolderName">Account Holder Name:</label>
                <input type="text" id="accountHolderName" name="accountHolderName" required
                    class="border rounded-md py-2 px-3">
            </div>
            <div class="flex gap-2">
                <label for="balance">Initial Balance:</label>
                <input type="number" id="balance" name="balance" required class="border rounded-md py-2 px-3">
            </div>
            <button type="submit"
                class="bg-blue-500 text-white font-bold py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:shadow-outline">
                Create Account
            </button>
        </form>
    </div>

    <div class="border-b-2 border-black w-full mb-8"></div>

    <div class="flex flex-col w-full items-center justify-center mb-8">
        <div class="font-semibold text-xl">Deposit</div>
        <form id="depositForm" class="gap-2 flex flex-col items-center mb-4 p-4 border rounded bg-white">
            <div class="flex gap-2">
                <label for="depositId">Account ID:</label>
                <input type="number" id="depositId" name="depositId" required class="border rounded-md py-2 px-3">
            </div>
            <div class="flex gap-2">
                <label for="depositAmount">Amount:</label>
                <input type="number" id="depositAmount" name="depositAmount" required
                    class="border rounded-md py-2 px-3">
            </div>
            <button type="submit"
                class="bg-blue-500 text-white font-bold py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:shadow-outline">
                Deposit
            </button>
        </form>
    </div>

    <div class="border-b-2 border-black w-full mb-8"></div>

    <div class="flex flex-col w-full items-center justify-center mb-8">
        <div class="font-semibold text-xl">Withdraw</div>
        <form id="withdrawForm" class="gap-2 flex flex-col items-center mb-4 p-4 border rounded bg-white">
            <div class="flex gap-2">
                <label for="withdrawId">Account ID:</label>
                <input type="number" id="withdrawId" name="withdrawId" required class="border rounded-md py-2 px-3">
            </div>
            <div class="flex gap-2">
                <label for="withdrawAmount">Amount:</label>
                <input type="number" id="withdrawAmount" name="withdrawAmount" required
                    class="border rounded-md py-2 px-3">
            </div>
            <button type="submit"
                class="bg-blue-500 text-white font-bold py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:shadow-outline">
                Withdraw
            </button>
        </form>
    </div>

    <div class="border-b-2 border-black w-full mb-8"></div>

    <div class="flex flex-col w-full items-center justify-center mb-8">
        <div class="font-semibold text-xl">Check Balance</div>
        <form id="getAccountForm" class="gap-2 flex flex-col items-center mb-4 p-4 border rounded bg-white">
            <div class="flex gap-2">
                <label for="accountId">Account ID:</label>
                <input type="number" id="accountId" name="accountId" required class="border rounded-md py-2 px-3">
            </div>
            <button type="submit"
                class="bg-blue-500 text-white font-bold py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:shadow-outline">
                Check Balance
            </button>
        </form>
    </div>

    <div id="accountDetails" class="font-semibold text-left px-4"></div>

    <script>
        // AJAX request to create an account
        document.getElementById("createAccountForm").addEventListener("submit", function (event) {
            event.preventDefault();
            let formData = new FormData(this);
            fetch("/api/accounts", {
                method: "POST",
                body: JSON.stringify({
                    accountHolderName: formData.get("accountHolderName"),
                    balance: formData.get("balance")
                }),
                headers: {
                    "Content-Type": "application/json"
                }
            })
                .then(response => response.json())
                .then(data => {
                    alert("Account created successfully with ID: " + data.id);
                    this.reset();
                })
                .catch(error => {
                    alert("Failed to create account: " + error.message);
                });
        });

        // AJAX request to deposit into an account
        document.getElementById("depositForm").addEventListener("submit", function (event) {
            event.preventDefault();
            let formData = new FormData(this);
            let accountId = formData.get("depositId");
            let amount = formData.get("depositAmount");
            fetch("/api/accounts/" + accountId + "/deposit", {
                method: "POST",
                body: JSON.stringify({ amount: amount }),
                headers: {
                    "Content-Type": "application/json"
                }
            })
                .then(response => response.json())
                .then(data => {
                    alert("Deposited successfully. New balance: " + data.balance);
                    this.reset();
                })
                .catch(error => {
                    alert("Failed to deposit: " + error.message);
                });
        });

        // AJAX request to withdraw from an account
        document.getElementById("withdrawForm").addEventListener("submit", function (event) {
            event.preventDefault();
            let formData = new FormData(this);
            let accountId = formData.get("withdrawId");
            let amount = formData.get("withdrawAmount");
            fetch("/api/accounts/" + accountId + "/withdraw", {
                method: "POST",
                body: JSON.stringify({ amount: amount }),
                headers: {
                    "Content-Type": "application/json"
                }
            })
                .then(response => response.json())
                .then(data => {
                    alert("Withdrawn successfully. New balance: " + data.balance);
                    this.reset();
                })
                .catch(error => {
                    alert("Failed to withdraw: " + error.message);
                });
        });

        // AJAX request to get account details by ID
        document.getElementById("getAccountForm").addEventListener("submit", function (event) {
            event.preventDefault();
            let accountId = document.getElementById("accountId").value;
            fetch("/api/accounts/" + accountId)
                .then(response => response.json())
                .then(data => {
                    document.getElementById("accountDetails").innerHTML = `
                    <h3>Account Details</h3>
                    <p>ID: ${data.id}</p>
                    <p>Account Holder Name: ${data.accountHolderName}</p>
                    <p>Balance: ${data.balance}</p>
                `;
                })
                .catch(error => {
                    alert("Failed to fetch account details: " + error.message);
                });
        });
    </script>
</body>

</html>
