<!DOCTYPE html>
<html>
<head>
    <title>Account Management</title>
</head>
<body>
    <h1>Account Management</h1>
    
    <h2>Create Account</h2>
    <form id="createAccountForm">
        <label for="accountHolderName">Account Holder Name:</label>
        <input type="text" id="accountHolderName" name="accountHolderName" required>
        <br>
        <label for="balance">Initial Balance:</label>
        <input type="number" id="balance" name="balance" required>
        <br>
        <button type="submit">Create Account</button>
    </form>
    
    <h2>Deposit</h2>
    <form id="depositForm">
        <label for="depositId">Account ID:</label>
        <input type="number" id="depositId" name="depositId" required>
        <br>
        <label for="depositAmount">Amount:</label>
        <input type="number" id="depositAmount" name="depositAmount" required>
        <br>
        <button type="submit">Deposit</button>
    </form>
    
    <h2>Withdraw</h2>
    <form id="withdrawForm">
        <label for="withdrawId">Account ID:</label>
        <input type="number" id="withdrawId" name="withdrawId" required>
        <br>
        <label for="withdrawAmount">Amount:</label>
        <input type="number" id="withdrawAmount" name="withdrawAmount" required>
        <br>
        <button type="submit">Withdraw</button>
    </form>

    <h2>Check Balance</h2>
    <form id="getAccountForm">
        <label for="accountId">Account ID:</label>
        <input type="number" id="accountId" name="accountId" required>
        <br>
        <button type="submit">Check Balance</button>
    </form>
    
    <div id="accountDetails"></div>

    <script>
        // AJAX request to create an account
        document.getElementById("createAccountForm").addEventListener("submit", function(event) {
            event.preventDefault();
            let formData = new FormData(this);
            fetch("/api/accounts", {
                method: "POST",
                body: JSON.stringify({
                    accountHolderName: formData.get("accountHolderName"),
                    balance: formData.get("balance")
                }),
                headers: {
                    "Content-Type": "application/json"
                }
            })
            .then(response => response.json())
            .then(data => {
                alert("Account created successfully with ID: " + data.id);
                this.reset();
            })
            .catch(error => {
                alert("Failed to create account: " + error.message);
            });
        });

        // AJAX request to deposit into an account
        document.getElementById("depositForm").addEventListener("submit", function(event) {
            event.preventDefault();
            let formData = new FormData(this);
            let accountId = formData.get("depositId");
            let amount = formData.get("depositAmount");
            fetch("/api/accounts/" + accountId + "/deposit", {
                method: "POST",
                body: JSON.stringify({ amount: amount }),
                headers: {
                    "Content-Type": "application/json"
                }
            })
            .then(response => response.json())
            .then(data => {
                alert("Deposited successfully. New balance: " + data.balance);
                this.reset();
            })
            .catch(error => {
                alert("Failed to deposit: " + error.message);
            });
        });

        // AJAX request to withdraw from an account
        document.getElementById("withdrawForm").addEventListener("submit", function(event) {
            event.preventDefault();
            let formData = new FormData(this);
            let accountId = formData.get("withdrawId");
            let amount = formData.get("withdrawAmount");
            fetch("/api/accounts/" + accountId + "/withdraw", {
                method: "POST",
                body: JSON.stringify({ amount: amount }),
                headers: {
                    "Content-Type": "application/json"
                }
            })
            .then(response => response.json())
            .then(data => {
                alert("Withdrawn successfully. New balance: " + data.balance);
                this.reset();
            })
            .catch(error => {
                alert("Failed to withdraw: " + error.message);
            });
        });

        // AJAX request to get account details by ID
        document.getElementById("getAccountForm").addEventListener("submit", function(event) {
            event.preventDefault();
            let accountId = document.getElementById("accountId").value;
            fetch("/api/accounts/" + accountId)
            .then(response => response.json())
            .then(data => {
                document.getElementById("accountDetails").innerHTML = `
                    <h3>Account Details</h3>
                    <p>ID: ${data.id}</p>
                    <p>Account Holder Name: ${data.accountHolderName}</p>
                    <p>Balance: ${data.balance}</p>
                `;
            })
            .catch(error => {
                alert("Failed to fetch account details: " + error.message);
            });
        });
    </script>
</body>
</html>
