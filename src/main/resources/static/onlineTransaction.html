<!DOCTYPE html>
<html>

<head>
    <title>Online Transaction Management</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="flex flex-col w-full h-screen text-center">
    <div class="font-bold text-2xl mt-4">Online Transaction Management</div>
    <div class="flex justify-center space-x-8 mt-8">
        <div class="w-1/2 bg-gray-100 border border-gray-300 rounded-lg">
            <div class="font-semibold text-xl mb-4 bg-gray-200 rounded-t-lg">Process Online Transaction</div>
            <form id="processOnlineTransactionForm" class="gap-2 flex flex-col items-center p-4">
                <div class="flex gap-2">
                    <label for="accountNumber">Account Number:</label>
                    <input type="text" id="accountNumber" name="accountNumber" required
                        class="border-2 border-black rounded-md">
                </div>
                <div class="flex gap-2">
                    <label for="transactionType">Transaction Type:</label>
                    <input type="text" id="transactionType" name="transactionType" required
                        class="border-2 border-black rounded-md">
                </div>
                <div class="flex gap-2">
                    <label for="amount">Amount:</label>
                    <input type="number" step="0.01" id="amount" name="amount" required
                        class="border-2 border-black rounded-md">
                </div>
                <button type="submit" class="bg-blue-500 text-white font-bold py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:shadow-outline">Process Transaction</button>
            </form>
        </div>

        <div class="w-1/2 bg-gray-100 border border-gray-300 rounded-lg">
            <div class="font-semibold text-xl mb-4 bg-gray-200 rounded-t-lg">Get Online Transactions</div>
            <form id="getOnlineTransactionsForm" class="gap-2 flex flex-col items-center p-4">
                <div class="flex gap-2">
                    <label for="accountNumber">Account Number:</label>
                    <input type="text" id="accountNumber" name="accountNumber" class="border-2 border-black rounded-md">
                </div>
                <button type="submit" class="bg-blue-500 text-white font-bold py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:shadow-outline">Get Online Transactions</button>
            </form>
            <div id="onlineTransactionsContainer" class="w-full max-w-md"></div>
        </div>
    </div>

    <script>
        // AJAX request to process an online transaction
        document.getElementById("processOnlineTransactionForm").addEventListener("submit", function (event) {
            event.preventDefault();
            const formData = new FormData(this);
            fetch("/api/online-transactions", {
                method: "POST",
                headers: {
                    "Content-Type": "application/json"
                },
                body: JSON.stringify({
                    accountNumber: formData.get("accountNumber"),
                    transactionType: formData.get("transactionType"),
                    amount: formData.get("amount")
                })
            })
                .then(response => response.json())
                .then(data => {
                    alert("Online transaction processed successfully");
                    this.reset();
                })
                .catch(error => {
                    alert("Failed to process online transaction: " + error.message);
                });
        });

        // AJAX request to get online transactions
        document.getElementById("getOnlineTransactionsForm").addEventListener("submit", function (event) {
            event.preventDefault();
            const formData = new FormData(this);
            const queryParams = new URLSearchParams();

            if (formData.get("accountNumber")) {
                queryParams.append("accountNumber", formData.get("accountNumber"));
            }

            fetch(`/api/online-transactions?${queryParams.toString()}`, {
                method: "GET"
            })
                .then(response => response.json())
                .then(data => {
                    displayOnlineTransactions(data);
                })
                .catch(error => {
                    alert("Failed to get online transactions: " + error.message);
                });
        });

        function displayOnlineTransactions(transactions) {
            const container = document.getElementById("onlineTransactionsContainer");
            container.innerHTML = "";

            if (transactions.length === 0) {
                container.innerHTML = "<p>No online transactions found.</p>";
                return;
            }

            const table = document.createElement("table");
            table.classList.add("table-auto", "w-full", "border", "border-gray-400");

            const thead = document.createElement("thead");
            const headerRow = document.createElement("tr");
            const headers = ["Account Number", "Transaction Type", "Amount", "Transaction Date"];
            headers.forEach(header => {
                const th = document.createElement("th");
                th.classList.add("px-4", "py-2", "border", "border-gray-400");
                th.textContent = header;
                headerRow.appendChild(th);
            });
            thead.appendChild(headerRow);
            table.appendChild(thead);

            const tbody = document.createElement("tbody");
            transactions.forEach(transaction => {
                const row = document.createElement("tr");
                const { accountNumber, transactionType, amount, transactionDate } = transaction;
                const cells = [accountNumber, transactionType, amount, transactionDate];
                cells.forEach(cell => {
                    const td = document.createElement("td");
                    td.classList.add("px-4", "py-2", "border", "border-gray-400");
                    td.textContent = cell;
                    row.appendChild(td);
                });
                tbody.appendChild(row);
            });
            table.appendChild(tbody);
            container.appendChild(table);
        }
    </script>
</body>

</html>
