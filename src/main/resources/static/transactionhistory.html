<!DOCTYPE html>
<html>

<head>
    <title>Transaction History Management</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="flex flex-col w-full h-screen text-center">
    <div class="font-bold text-2xl mt-4">Transaction History Management</div>
    <div class="flex justify-center space-x-8 mt-8">
        <div class="w-1/2 bg-gray-100 border border-gray-300 rounded-lg">
            <div class="font-semibold text-xl mb-4 bg-gray-200 rounded-t-lg">Get Transaction History</div>
            <form id="getTransactionHistoryForm" class="gap-2 flex flex-col items-center p-4">
                <div class="flex gap-2">
                    <label for="accountNumber">Account Number:</label>
                    <input type="text" id="accountNumber" name="accountNumber" class="border-2 border-black rounded-md">
                </div>
                <button type="submit" class="bg-blue-500 text-white font-bold py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:shadow-outline">Get Transaction History</button>
            </form>
            <div id="transactionHistoryContainer" class="w-full max-w-md"></div>
        </div>
    </div>

    <script>
        // AJAX request to get transaction history
        document.getElementById("getTransactionHistoryForm").addEventListener("submit", function (event) {
            event.preventDefault();
            const formData = new FormData(this);
            const queryParams = new URLSearchParams();

            if (formData.get("accountNumber")) {
                queryParams.append("accountNumber", formData.get("accountNumber"));
            }

            fetch(`/api/transaction-history?${queryParams.toString()}`, {
                method: "GET"
            })
                .then(response => response.json())
                .then(data => {
                    displayTransactionHistory(data);
                })
                .catch(error => {
                    alert("Failed to get transaction history: " + error.message);
                });
        });

        function displayTransactionHistory(transactions) {
            const container = document.getElementById("transactionHistoryContainer");
            container.innerHTML = "";

            if (transactions.length === 0) {
                container.innerHTML = "<p>No transaction history found.</p>";
                return;
            }

            const table = document.createElement("table");
            table.classList.add("table-auto", "w-full", "border", "border-gray-400");

            const thead = document.createElement("thead");
            const headerRow = document.createElement("tr");
            const headers = ["Account Number", "Transaction Type", "Amount", "Transaction Date"];
            headers.forEach(header => {
                const th = document.createElement("th");
                th.classList.add("px-4", "py-2", "border", "border-gray-400");
                th.textContent = header;
                headerRow.appendChild(th);
            });
            thead.appendChild(headerRow);
            table.appendChild(thead);

            const tbody = document.createElement("tbody");
            transactions.forEach(transaction => {
                const row = document.createElement("tr");
                const { accountNumber, transactionType, amount, transactionDate } = transaction;
                const cells = [accountNumber, transactionType, amount, transactionDate];
                cells.forEach(cell => {
                    const td = document.createElement("td");
                    td.classList.add("px-4", "py-2", "border", "border-gray-400");
                    td.textContent = cell;
                    row.appendChild(td);
                });
                tbody.appendChild(row);
            });
            table.appendChild(tbody);
            container.appendChild(table);
        }
    </script>
</body>

</html>
